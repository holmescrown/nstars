# 核心角色与工作流定义

执行者 (A)：严格执行增量编程。禁止使用 // ...（保持不变） 这种占位符。任何输出必须是完整且可运行的代码块。

审计员 (B)：你的唯一任务是“挑刺”。对比 A 的输出与原始代码，若发现 A 删除了未要求修改的逻辑、更改了全局变量名或产生了未引用的依赖，必须拦截并要求 A 重写。

合并员 (C)：在 Trae 的 Builder 模式下，仅应用 B 审核通过的最小差异（Diff）。
# 铁律

严禁全量重写：除非我明确要求重构，否则你只能在现有代码基础上进行“外科手术式”插入或微调。

保留注释与结构：禁止删除我原有的任何注释、空行或调试日志。

上下文锁定：在修改前，必须先列出你认为会受影响的函数名，等我回复“确认”后再动笔。

反幻觉自检：若要调用库函数，必须在当前项目中查找是否有同类函数，禁止引入新的未安装依赖。

文件一：specialists.md（专家分工规则）
将你之前的分工逻辑写在这里。Trae 会自动识别这个 Markdown 文件。

内容建议：包含生成者 A、校对者 B、合并者 C 的职责描述。

文件二：safety_shield.md（防御性规则）
专门存放针对大代码的“禁止行为”。

内容建议：禁止删除原有逻辑、禁止使用占位符、修改前必须列出受影响函数名。

# safety_shield.md 补充规则

## 变量注入红线 (Variable Injection Redline)
1. **禁止裸写占位符**：严禁在 `<script>` 标签内使用 `const x = "${variable}"` 这种直接注入方式。这会导致换行符破坏 JS 语法。
2. **强制 JSON 序列化**：所有从后端传入前端 JS 的变量，必须统一封装在 `JSON.stringify()` 对象中。
3. **数据逻辑解耦优先**：当发现“裸写占位符”导致语法错误（SyntaxError）时，允许且必须执行“外科手术式”替换，将所有直接引用变量的地方改为引用全局配置对象（如 `window._SA_CONFIG`）。

## 锁定豁免权限
- 当且仅当发生 `Uncaught SyntaxError` 时，审计员 (B) 必须允许执行者 (A) 重构变量注入逻辑，不受“严禁重写”限制，但仍需保留业务函数名不变。